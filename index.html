<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>PTN Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f7fa;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    h2 {
      margin-top: 20px;
      margin-bottom: 10px;
      color: #2c3e50;
    }
    .card {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      background: #3498db;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    button:hover {
      background: #2980b9;
    }
    iframe {
      border: 1px solid #ddd;
      border-radius: 8px;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    /* Layout Form + Sheet */
    .form-sheet-container {
      display: flex;
      gap: 20px;
      margin-top: 10px;
    }
    .form-sheet-container iframe {
      flex: 1;
      width: 100%;
      min-height: 600px;
    }
    .form-frame { max-width: 640px; }
    .sheet-frame { max-width: 800px; }

    /* Responsive: mobile xuống hàng */
    @media (max-width: 900px) {
      .form-sheet-container {
        flex-direction: column;
      }
      .form-frame, .sheet-frame {
        max-width: 100%;
      }
    }

    /* Link thư mục */
    .folder-links a {
      display: block;
      margin: 6px 0;
      padding: 8px 12px;
      background: #ecf0f1;
      border-radius: 6px;
      color: #2980b9;
      font-weight: bold;
      text-decoration: none;
      transition: 0.2s;
    }
    .folder-links a:hover {
      background: #d6eaf8;
      text-decoration: underline;
    }
    /* --- STYLE BẢNG 5 CỘT 29 HÀNG --- */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      border-radius: 8px;
      overflow: hidden;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background: #f0f3f5;
      font-weight: bold;
    }
    tr:nth-child(even) td {
      background: #fafafa;
    }
    td a {
      display: block;
      color: #005bbb;
      font-weight: bold;
      text-decoration: none;
      transition: 0.2s;
    }
    td a:hover {
      color: #ff6600;
    }
  </style>
</head>
<body>
  <h1>PTN Dashboard</h1> 

  <!-- Camera -->
  <div class="card">
    <h2>Chụp ảnh thí nghiệm</h2> 
    <video id="video" autoplay width="400" height="300"></video><br>
    <button id="capture">Chụp ảnh</button>
    <canvas id="canvas" style="display:none;"></canvas>
    <!-- ⭐⭐⭐ BẢNG MÀ MÀY MUỐN THÊM VÀO ⭐⭐⭐ -->
    <h2 style="margin-top:30px;">Bảng liên kết</h2>
    <table>
      <tr>
        <th rowspan="2">Cột 1</th>
        <th colspan="4">Nhóm cột 2–5</th>
      </tr>

      <tr>
        <th>Cột 2</th>
        <th>Cột 3</th>
        <th>Cột 4</th>
        <th>Cột 5</th>
      </tr>

      <!-- 27 hàng còn lại (tạo mẫu 1 hàng), muốn tao tạo đủ 29 thì tao làm luôn -->
      <tr>
        <td><a href="#">Link 1</a></td>
        <td><a href="#">Link 2</a></td>
        <td><a href="#">Link 3</a></td>
        <td><a href="#">Link 4</a></td>
        <td><a href="#">Link 5</a></td>
      </tr>
    </table>
  </div>

  <!-- Form + Sheets -->
  <div class="card">
    <h2>Công việc & Theo dõi</h2>
    <div class="form-sheet-container">
      <!-- Google Form -->
      <iframe class="form-frame" src="https://docs.google.com/forms/d/e/1FAIpQLSfRll9yQzmv5t9OHBKAZFYpNKtb6chKqn8lcJ3nfc1U8NFEiA/viewform?embedded=true"></iframe>

      <!-- Google Sheets -->
      <iframe class="sheet-frame" src="https://docs.google.com/spreadsheets/d/1t6ZJf5wu2iSf5spfFx-fP8tT9-AZUEQ-17xUn8YiSMo/edit?usp=sharing"></iframe>
    </div>
  </div>

  <!-- Google Drive folders -->
  <div class="card">
    <h2>Các thư mục quan trọng</h2> 
    <div class="folder-links">
      <a href="https://drive.google.com/drive/folders/1yed3TBGnktmakcwekL60fOOOBgousdA_?usp=sharing" target="_blank">Ảnh thí nghiệm</a>
      <a href="https://drive.google.com/drive/folders/1Onjlnxh62Br5QglU_YCJ67jG8JYt6nBn?usp=sharing" target="_blank">Yêu cầu thí nghiệm</a>
      <a href="https://drive.google.com/drive/folders/11DVnrcLxa3NHv-Y23emDZ36Lob3BwB9N?usp=sharing" target="_blank">Biểu nhập số thí nghiệm</a>
    </div>
  </div>

<script>
  const video = document.getElementById('video'); 
  const canvas = document.getElementById('canvas'); 
  const captureBtn = document.getElementById('capture');  

  // Bật camera
  navigator.mediaDevices.getUserMedia({ video: true }).then(stream => { 
    video.srcObject = stream; 
  });  

  // Chụp ảnh và gửi lên Google Apps Script 
  captureBtn.onclick = () => { 
    const context = canvas.getContext('2d'); 
    canvas.width = video.videoWidth; 
    canvas.height = video.videoHeight; 
    context.drawImage(video, 0, 0); 

    const dataUrl = canvas.toDataURL("image/png").replace(/^data:image\/png;base64,/, ""); 

    fetch("https://script.google.com/macros/s/AKfycbyOT1qP3OTTXy-X6dRAJKuZS1HKTVVTqxMKgn3IxyiZks99kTcQcMiy0hiJ6QuCAUQ/exec", {  // thay link Apps Script Web App vào đây
      method: "POST", 
      body: new URLSearchParams({ image: dataUrl }) 
    }) 
    .then(res => res.text()) 
    .then(txt => alert("Uploaded: " + txt)); 
  }; 
</script>
</body>
</html>

